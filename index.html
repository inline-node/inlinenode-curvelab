<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>InlineNode Tools</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">

  <!-- Plotly & Math.js -->
  <script src="https://cdn.plot.ly/plotly-2.24.2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjs@11.8.0/lib/browser/math.js"></script>

  <link rel="stylesheet" href="src/css/style.css">
</head>
<body>
  <div id="app" data-theme="light" class="app">
    <aside class="sidebar" aria-label="Main navigation">
      <div class="brand">
        <div class="brand-title">InlineNode Tools</div>
      </div>

      <nav class="nav" role="navigation" aria-label="Primary">
        <button class="nav-item active" data-view="curvelab">CurveLab</button>

        <div class="nav-group">
          <button class="nav-item group-toggle" data-group="electools">ElecTools ▾</button>
          <div class="nav-sub" id="electools-sub">
            <button class="nav-sub-item" data-view="elec-vd">Voltage Divider</button>
            <button class="nav-sub-item" data-view="elec-ohm">Ohm's Law</button>
            <button class="nav-sub-item" data-view="elec-rc">RC Time Constant</button>
            <button class="nav-sub-item" data-view="elec-rp">Series / Parallel</button>
          </div>
        </div>

        <button class="nav-item" data-view="about">About</button>
      </nav>

      <div class="sidebar-bottom">
        <div class="theme-toggle">
          <label class="switch">
            <input id="theme-switch" type="checkbox" />
            <span class="slider"></span>
          </label>
          <div class="theme-label">Dark mode</div>
        </div>
        <div class="version">v0.5</div>
      </div>
    </aside>

    <main class="main" role="main">
      <header class="main-header">
        <h1 id="main-title">CurveLab</h1>
      </header>

      <!-- WORKSPACE -->
      <section id="workspace" class="workspace">
        <!-- CurveLab layout (default) -->
        <div id="curvelab" class="panel view active">
          <div class="panel-left">
            <div class="card">
              <h3>Data table (editable)</h3>
              <div class="table-wrap">
                <table id="data-table" class="data-table" aria-label="Data input table">
                  <thead><tr><th>X</th><th>Y</th></tr></thead>
                  <tbody></tbody>
                </table>
              </div>

              <div class="table-controls">
                <label class="btn ghost small">
                  <input id="file-csv" type="file" accept=".csv" style="display:none" />
                  Import CSV
                </label>
                <button id="export-csv" class="btn ghost small">Export CSV</button>
                <button id="clear-table" class="btn ghost small">Clear table</button>
              </div>

              <div class="hint small muted">Tip: Paste from Excel / Sheets. Only first two columns (X,Y) will be used.</div>

              <div class="fit-controls">
                <select id="fit-type" aria-label="Select fit type">
                  <option value="linear">Linear</option>
                  <option value="polynomial">Polynomial</option>
                  <option value="exponential">Exponential</option>
                  <option value="logarithmic">Logarithmic</option>
                </select>
                <label id="deg-label" style="display:none">Degree</label>
                <input id="poly-degree" type="number" min="1" max="8" value="2" style="width:72px;display:none" />
                <button id="btn-fit" class="btn">Fit</button>
              </div>
            </div>
          </div>

          <div class="panel-right">
            <div class="card card-plot">
              <h3>Plot</h3>
              <div id="plot" class="plot"></div>
              <div id="fit-info" class="fit-info monospace" aria-live="polite"></div>
            </div>
          </div>
        </div>

        <!-- ElecTools pages: each is its own .view -->
        <div id="elec-vd" class="panel view" style="display:none">
          <div class="panel-left">
            <div class="card">
              <h3>Voltage Divider — Inputs</h3>
              <div class="grid-3">
                <label>Source voltage (Vin)</label><input id="vd-vin" type="number" step="any"><div class="units">V</div>

                <label>R1 (top)</label>
                <div class="input-with-unit">
                  <input id="vd-r1" type="number" step="any">
                  <select id="vd-r1-unit" class="unit-select"><option value="1">Ω</option><option value="1000">kΩ</option></select>
                </div><div class="units">Ω</div>

                <label>R2 (bottom)</label>
                <div class="input-with-unit">
                  <input id="vd-r2" type="number" step="any">
                  <select id="vd-r2-unit" class="unit-select"><option value="1">Ω</option><option value="1000">kΩ</option></select>
                </div><div class="units">Ω</div>

                <label>Output voltage (Vout)</label><input id="vd-vout" type="number" step="any"><div class="units">V</div>
              </div>

              <div class="calc-actions">
                <button id="vd-calc" class="btn">Calculate</button>
                <button id="vd-clear" class="btn ghost">Clear</button>
              </div>
            </div>
          </div>

          <div class="panel-right">
            <div class="card">
              <h3>Formula & Notes</h3>
              <div class="explain monospace">
                Equation: Vout = Vin × (R2 / (R1 + R2))
                <div class="small muted">Provide any three of Vin, R1, R2, Vout to compute the fourth. R units selectable Ω / kΩ.</div>
              </div>
              <div id="vd-result" class="calc-result monospace" aria-live="polite"></div>
            </div>
          </div>
        </div>

        <!-- Ohm's Law -->
        <div id="elec-ohm" class="panel view" style="display:none">
          <div class="panel-left">
            <div class="card">
              <h3>Ohm's Law — Inputs</h3>
              <div class="grid-3">
                <label>Voltage (V)</label><input id="ohm-v" type="number" step="any"><div class="units">V</div>
                <label>Current (I)</label><input id="ohm-i" type="number" step="any"><div class="units">A</div>
                <label>Resistance (R)</label>
                <div class="input-with-unit">
                  <input id="ohm-r" type="number" step="any">
                  <select id="ohm-r-unit" class="unit-select"><option value="1">Ω</option><option value="1000">kΩ</option></select>
                </div><div class="units">Ω</div>
                <label>Power (P)</label><input id="ohm-p" type="number" step="any"><div class="units">W</div>
              </div>

              <div class="calc-actions">
                <button id="ohm-calc" class="btn">Calculate</button>
                <button id="ohm-clear" class="btn ghost">Clear</button>
              </div>
            </div>
          </div>

          <div class="panel-right">
            <div class="card">
              <h3>Formula & Notes</h3>
              <div class="explain monospace">V = I × R   •   P = V × I</div>
              <div id="ohm-result" class="calc-result monospace" aria-live="polite"></div>
            </div>
          </div>
        </div>

        <!-- RC -->
        <div id="elec-rc" class="panel view" style="display:none">
          <div class="panel-left">
            <div class="card">
              <h3>RC Time Constant — Inputs</h3>
              <div class="grid-3">
                <label>Resistance (R)</label>
                <div class="input-with-unit">
                  <input id="rc-r" type="number" step="any">
                  <select id="rc-r-unit" class="unit-select"><option value="1">Ω</option><option value="1000">kΩ</option></select>
                </div><div class="units">Ω</div>
                <label>Capacitance (C)</label><input id="rc-c" type="number" step="any" placeholder="e.g. 1e-6"><div class="units">F</div>
                <label>Time constant (τ)</label><input id="rc-tau" type="text" readonly><div class="units">s</div>
              </div>

              <div class="calc-actions">
                <button id="rc-calc" class="btn">Calculate τ</button>
                <button id="rc-clear" class="btn ghost">Clear</button>
              </div>
            </div>
          </div>

          <div class="panel-right">
            <div class="card">
              <h3>Formula & Notes</h3>
              <div class="explain monospace">τ = R × C</div>
              <div id="rc-result" class="calc-result monospace" aria-live="polite"></div>
            </div>
          </div>
        </div>

        <!-- Series/Parallel -->
        <div id="elec-rp" class="panel view" style="display:none">
          <div class="panel-left">
            <div class="card">
              <h3>Series / Parallel — Inputs</h3>
              <div class="grid-3">
                <label>R A</label><input id="rp-a" type="number" step="any"><div class="units">Ω</div>
                <label>R B</label><input id="rp-b" type="number" step="any"><div class="units">Ω</div>
                <label>Mode</label><select id="rp-mode"><option value="series">Series</option><option value="parallel">Parallel</option></select><div class="units"></div>
              </div>

              <div class="calc-actions">
                <button id="rp-calc" class="btn">Compute</button>
                <button id="rp-clear" class="btn ghost">Clear</button>
              </div>
            </div>
          </div>

          <div class="panel-right">
            <div class="card">
              <h3>Formula & Notes</h3>
              <div class="explain monospace">Series: R = RA + RB  •  Parallel: 1/R = 1/RA + 1/RB</div>
              <div id="rp-result" class="calc-result monospace" aria-live="polite"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Logger (global) -->
      <section class="logger-wrap">
        <div id="logger" class="logger" role="log" aria-live="polite"></div>
      </section>

      <footer class="footer">© InlineNode</footer>
    </main>
  </div>

  <!-- JS -->
  <script src="src/js/logger.js"></script>
  <script src="src/js/utils.js"></script>
  <script src="src/js/regression.js"></script>
  <script src="src/js/plot.js"></script>
  <script src="src/js/calculators.js"></script>
  <script src="src/js/main.js"></script>
</body>
</html>
